"use strict";(self.webpackChunkaiconfig_docs=self.webpackChunkaiconfig_docs||[]).push([[62],{923:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var n=t(5893),i=t(1151);t(4866),t(5162),t(4883);const a={sidebar_position:14},s="Extensibility",o={id:"extensibility",title:"Extensibility",description:"AIConfig is designed to be customized and extended for your use-case. There are some key extension points for AIConfig:",source:"@site/docs/extensibility.md",sourceDirName:".",slug:"/extensibility",permalink:"/docs/extensibility",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:14,frontMatter:{sidebar_position:14},sidebar:"docSidebar",previous:{title:"Prompt Routing",permalink:"/docs/cookbooks/prompt-routing"},next:{title:"Contributing Guidelines",permalink:"/docs/contributing"}},l={},d=[{value:"1. Bring your own Model",id:"1-bring-your-own-model",level:2},{value:"Define a custom <code>ModelParser</code>",id:"define-a-custom-modelparser",level:3},{value:"<code>ModelParser</code> class",id:"modelparser-class",level:3},{value:"<code>ModelParser</code> extensibility",id:"modelparser-extensibility",level:3},{value:"<code>ParameterizedModelParser</code> class",id:"parameterizedmodelparser-class",level:3},{value:"<code>ParameterizedModelParser</code> extensibility",id:"parameterizedmodelparser-extensibility",level:3},{value:"Helper Utils for <code>ParameterizedModelParser</code>",id:"helper-utils-for-parameterizedmodelparser",level:3},{value:"Helper Utilities for Parameterization",id:"helper-utilities-for-parameterization",level:3},{value:"Contributing",id:"contributing",level:3},{value:"2. Callback handlers",id:"2-callback-handlers",level:2},{value:"3. Custom metadata",id:"3-custom-metadata",level:2}];function c(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h1,{id:"extensibility",children:"Extensibility"}),"\n",(0,n.jsx)(r.p,{children:"AIConfig is designed to be customized and extended for your use-case. There are some key extension points for AIConfig:"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Supporting other models (BYO Model)"}),"\n",(0,n.jsx)(r.li,{children:"Callback event handlers"}),"\n",(0,n.jsx)(r.li,{children:"Custom metadata"}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"1-bring-your-own-model",children:"1. Bring your own Model"}),"\n",(0,n.jsxs)(r.p,{children:["You can use any generative AI model with the ",(0,n.jsx)(r.code,{children:"aiconfig"})," format. All you need to do is define a ",(0,n.jsx)(r.code,{children:"ModelParser"})," class. This class is responsible for 3 key operations:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"serialize"})," prompts, model parameters and inference outputs into an ",(0,n.jsx)(r.code,{children:"aiconfig"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"deserialize"})," existing ",(0,n.jsx)(r.code,{children:"aiconfig"})," ",(0,n.jsx)(r.code,{children:"Prompts"})," for that model into the data that the model accepts (e.g. OpenAI chat completion params)."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"run"})," inference using a model (e.g. calling the OpenAI API or a model running locally)."]}),"\n"]}),"\n",(0,n.jsxs)(r.h3,{id:"define-a-custom-modelparser",children:["Define a custom ",(0,n.jsx)(r.code,{children:"ModelParser"})]}),"\n",(0,n.jsxs)(r.p,{children:["In this guide, you will learn the basics of defining your own custom ",(0,n.jsx)(r.code,{children:"ModelParser"})," for use in the AIConfig library. ",(0,n.jsx)(r.code,{children:"ModelParser"}),"s play a crucial role in managing and interacting with AI models within the AIConfig SDK. You can create custom ",(0,n.jsx)(r.code,{children:"ModelParser"}),"s to suit your specific needs and integrate them seamlessly into AIConfig."]}),"\n",(0,n.jsxs)(r.h3,{id:"modelparser-class",children:[(0,n.jsx)(r.code,{children:"ModelParser"})," class"]}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"ModelParser"})," is an abstract base class that serves as the foundation for all ",(0,n.jsx)(r.code,{children:"ModelParser"}),"s. It defines a set of methods and behaviors that any ",(0,n.jsx)(r.code,{children:"ModelParser"})," implementation must adhere to. Below are the key methods defined in the ",(0,n.jsx)(r.code,{children:"ModelParser"})," class:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"id()"}),'\nReturns an identifier for the model parser (e.g., "OpenAIModelParser, HuggingFaceTextGeneration", etc.).']}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"serialize()"}),"\nSerialize a prompt and additional metadata/model settings into a ",(0,n.jsx)(r.code,{children:"Prompt"})," object that can be saved in the AIConfig."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"deserialize()"}),"\nDeserialize a ",(0,n.jsx)(r.code,{children:"Prompt"})," object loaded from an AIConfig into a structure that can be used for model inference."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"run()"}),"\nExecute model inference based on completion data constructed in the ",(0,n.jsx)(r.code,{children:"deserialize()"})," method. It saves the response or output in ",(0,n.jsx)(r.code,{children:"prompt.outputs"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"get_output_text()"}),": Get the output text from the output object containing model inference response."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"get_model_settings()"}),": Extract the AI model's settings from the AIConfig"]}),"\n"]}),"\n",(0,n.jsxs)(r.h3,{id:"modelparser-extensibility",children:[(0,n.jsx)(r.code,{children:"ModelParser"})," extensibility"]}),"\n",(0,n.jsxs)(r.p,{children:["When defining your custom ",(0,n.jsx)(r.code,{children:"ModelParser"}),", you can inherit from the ",(0,n.jsx)(r.code,{children:"ModelParser"})," class and override its methods as needed to customize the behavior for your specific AI models. This extensibility allows you to seamlessly integrate your ",(0,n.jsx)(r.code,{children:"ModelParser"})," into the AIConfig framework and manage AI models with ease."]}),"\n",(0,n.jsx)(r.p,{children:"Here are some helpful resources to get started:"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"ModelParser"})," class (",(0,n.jsx)(r.a,{href:"https://github.com/lastmile-ai/aiconfig/blob/main/python/src/aiconfig/model_parser.py",children:"Python"}),", ",(0,n.jsx)(r.a,{href:"https://github.com/lastmile-ai/aiconfig/blob/main/typescript/lib/modelParser.ts",children:"TypeScript"}),")."]}),"\n",(0,n.jsxs)(r.li,{children:["OpenAI Chat ",(0,n.jsx)(r.code,{children:"ModelParser"})," (",(0,n.jsx)(r.a,{href:"https://github.com/lastmile-ai/aiconfig/blob/main/python/src/aiconfig/default_parsers/openai.py#L25",children:"Python"}),", ",(0,n.jsx)(r.a,{href:"https://github.com/lastmile-ai/aiconfig/blob/main/typescript/lib/parsers/openai.ts#L261",children:"TypeScript"}),")"]}),"\n"]}),"\n",(0,n.jsxs)(r.h3,{id:"parameterizedmodelparser-class",children:[(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})," class"]}),"\n",(0,n.jsxs)(r.p,{children:["In some cases, you may want to create a specialized ",(0,n.jsx)(r.code,{children:"ModelParser"})," that handles parameterization of prompts. ",(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})," is an abstract subclass of ",(0,n.jsx)(r.code,{children:"ModelParser"})," that provides additional methods and utilities for parameterization."]}),"\n",(0,n.jsxs)(r.admonition,{type:"info",children:[(0,n.jsx)(r.p,{children:"In AIConfig, parameters refer to the handlebar syntax used by prompt inputs to denote a placeholder for another value. Learn more in the following sections:"}),(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"/docs/overview/parameters",children:"Passing data into prompts"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"/docs/overview/define-prompt-chain",children:"Parameter chains"})}),"\n"]})]}),"\n",(0,n.jsxs)(r.h3,{id:"parameterizedmodelparser-extensibility",children:[(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})," extensibility"]}),"\n",(0,n.jsxs)(r.p,{children:["When defining your own custom ",(0,n.jsx)(r.code,{children:"ModelParser"}),", you can choose to inherit from the ",(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})," class to take advantage of the parameterization features provided by AIConfig. This allows you to create model parsers that can handle prompts with placeholders and dynamically replace them with actual values during serialization and deserialization."]}),"\n",(0,n.jsx)(r.p,{children:"By incorporating parameterization into your model parser, you can create AIConfigs that are more flexible and adaptable to different use cases, as well as facilitate the customization of prompt templates to meet specific requirements."}),"\n",(0,n.jsxs)(r.p,{children:["Another notable benefit of using parameterization is the ability to leverage the ",(0,n.jsx)(r.code,{children:"run_with_dependencies"})," feature. The ",(0,n.jsx)(r.code,{children:"run_with_dependencies"})," API method allows you to execute prompts with resolved dependencies and prompt references, providing more advanced control over the model's behavior."]}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})," class and associated helper utilities empower you to harness the power of parameterization in your AI configuration management, offering greater flexibility and control over how prompts are processed and used in model inference."]}),"\n",(0,n.jsxs)(r.h3,{id:"helper-utils-for-parameterizedmodelparser",children:["Helper Utils for ",(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})]}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})," class extends the capabilities of the base ",(0,n.jsx)(r.code,{children:"ModelParser"})," and includes the following methods:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Python ",(0,n.jsx)(r.code,{children:"resolve_prompt_template()"})," TypeScript: ",(0,n.jsx)(r.code,{children:"resolvePromptTemplate()"}),"\nResolves a templated string with provided parameters, allowing for dynamic prompt generation."]}),"\n",(0,n.jsxs)(r.li,{children:["Python ",(0,n.jsx)(r.code,{children:"get_prompt_template()"})," TypeScript: ",(0,n.jsx)(r.code,{children:"getPromptTemplate()"}),"\nAn overrideable method that returns a template for a prompt. Customize this method to specify how prompt templates are extracted from prompts."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"helper-utilities-for-parameterization",children:"Helper Utilities for Parameterization"}),"\n",(0,n.jsx)(r.p,{children:"To facilitate parameterization, AIConfig provides a set of helper utilities:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Python: ",(0,n.jsx)(r.code,{children:"resolve_parameters()"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Resolves parameters within a given string by substituting placeholders with actual values."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["Python: ",(0,n.jsx)(r.code,{children:"resolve_prompt_string()"})," TypeScript: ",(0,n.jsx)(r.code,{children:"resolvePromptString()"}),"\nResolves a templated string with parameters, similar to the ",(0,n.jsx)(r.code,{children:"resolve_prompt_template()"})," method of the ",(0,n.jsx)(r.code,{children:"ParameterizedModelParser"})," class."]}),"\n",(0,n.jsxs)(r.li,{children:["Python: ",(0,n.jsx)(r.code,{children:"resolve_parametrized_prompt()"})," TypeScript: ",(0,n.jsx)(r.code,{children:"resolvePrompt() "}),"\nResolves a parametrized prompt by substituting parameter placeholders with their corresponding values."]}),"\n",(0,n.jsxs)(r.li,{children:["Python: ",(0,n.jsx)(r.code,{children:"resolve_system_prompt()"})," TypeScript: ",(0,n.jsx)(r.code,{children:"resolvePrompt() "}),"\nResolves system prompts, often used in multi-turn conversations, by applying parameterization to system prompt templates."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"These utilities enable dynamic parameterization of prompts and customization of prompt templates to meet specific requirements."}),"\n",(0,n.jsx)(r.h3,{id:"contributing",children:"Contributing"}),"\n",(0,n.jsxs)(r.p,{children:["Have a custom ",(0,n.jsx)(r.code,{children:"ModelParser"})," implementation that others may find useful? Please consider packaging it as an AIConfig Extension by following our ",(0,n.jsx)(r.a,{href:"/docs/contributing",children:"Contributing Guidelines"}),"!"]}),"\n",(0,n.jsx)(r.h2,{id:"2-callback-handlers",children:"2. Callback handlers"}),"\n",(0,n.jsxs)(r.p,{children:["The AIConfig SDK has a ",(0,n.jsx)(r.code,{children:"CallbackManager"})," class provides a stack trace of what's going on under the covers, which is especially useful for complex control flow operations."]}),"\n",(0,n.jsx)(r.p,{children:"Anyone can register a callback, and filter for the events they care about. You can subsequently use these callbacks to integrate with your own monitoring and observability systems."}),"\n",(0,n.jsxs)(r.p,{children:["See the ",(0,n.jsx)(r.a,{href:"/docs/overview/monitoring-aiconfig",children:(0,n.jsx)(r.strong,{children:"Tracing & Monitoring"})})," section to learn how to use event callbacks"]}),"\n",(0,n.jsx)(r.h2,{id:"3-custom-metadata",children:"3. Custom metadata"}),"\n",(0,n.jsxs)(r.p,{children:["You can store any kind of JSON-serializable metadata in an ",(0,n.jsx)(r.code,{children:"aiconfig"}),". See the ",(0,n.jsx)(r.a,{href:"/docs/overview/ai-config-format#metadata",children:"metadata schema details"})," to learn more."]}),"\n",(0,n.jsxs)(r.p,{children:["To add metadata, use the ",(0,n.jsx)(r.code,{children:"config.set_metadata"})," (Python) or ",(0,n.jsx)(r.code,{children:"config.setMetadata"})," (TypeScript) API."]})]})}function u(e={}){const{wrapper:r}={...(0,i.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},4883:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(412);const i=!!n.Z.canUseDOM&&navigator.platform.startsWith("Mac"),a=!!n.Z.canUseDOM&&navigator.platform.startsWith("Win"),s={defaultOs:i?"macos":a?"windows":"linux",defaultNodePackageManager:"npm",defaultPythonPackageManager:"pip",defaultPlatform:i?"ios":"android",defaultSyntax:"functional",defaultAIConfigLanguage:"python",getDevNotesTabs:function(e){return void 0===e&&(e=["android","ios","web","windows"]),[e.includes("android")?{label:"Android",value:"android"}:void 0,e.includes("ios")?{label:"iOS",value:"ios"}:void 0,e.includes("web")?{label:"Web",value:"web"}:void 0,e.includes("windows")?{label:"Windows",value:"windows"}:void 0].filter(Boolean)},oses:[{label:"macOS",value:"macos"},{label:"Windows",value:"windows"},{label:"Linux",value:"linux"}],nodePackageManagers:[{label:"npm",value:"npm"},{label:"Yarn",value:"yarn"}],pythonPackageManagers:[{label:"pip",value:"pip"},{label:"poetry",value:"poetry"}],platforms:[{label:"Android",value:"android"},{label:"iOS",value:"ios"}],aiConfigLanguages:[{label:"TypeScript",value:"node"},{label:"Python",value:"python"}]}},5162:(e,r,t)=>{t.d(r,{Z:()=>s});t(7294);var n=t(6010);const i={tabItem:"tabItem_Ymn6"};var a=t(5893);function s(e){let{children:r,hidden:t,className:s}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,n.Z)(i.tabItem,s),hidden:t,children:r})}},4866:(e,r,t)=>{t.d(r,{Z:()=>P});var n=t(7294),i=t(6010),a=t(2466),s=t(6550),o=t(469),l=t(1980),d=t(7392),c=t(12);function u(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:r,children:t}=e;return(0,n.useMemo)((()=>{const e=r??function(e){return u(e).map((e=>{let{props:{value:r,label:t,attributes:n,default:i}}=e;return{value:r,label:t,attributes:n,default:i}}))}(t);return function(e){const r=(0,d.l)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,t])}function p(e){let{value:r,tabValues:t}=e;return t.some((e=>e.value===r))}function m(e){let{queryString:r=!1,groupId:t}=e;const i=(0,s.k6)(),a=function(e){let{queryString:r=!1,groupId:t}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:r,groupId:t});return[(0,l._X)(a),(0,n.useCallback)((e=>{if(!a)return;const r=new URLSearchParams(i.location.search);r.set(a,e),i.replace({...i.location,search:r.toString()})}),[a,i])]}function f(e){const{defaultValue:r,queryString:t=!1,groupId:i}=e,a=h(e),[s,l]=(0,n.useState)((()=>function(e){let{defaultValue:r,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!p({value:r,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:r,tabValues:a}))),[d,u]=m({queryString:t,groupId:i}),[f,x]=function(e){let{groupId:r}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(r),[i,a]=(0,c.Nk)(t);return[i,(0,n.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:i}),b=(()=>{const e=d??f;return p({value:e,tabValues:a})?e:null})();(0,o.Z)((()=>{b&&l(b)}),[b]);return{selectedValue:s,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),x(e)}),[u,x,a]),tabValues:a}}var x=t(2389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=t(5893);function j(e){let{className:r,block:t,selectedValue:n,selectValue:s,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.o5)(),c=e=>{const r=e.currentTarget,t=l.indexOf(r),i=o[t].value;i!==n&&(d(r),s(i))},u=e=>{let r=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;r=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;r=l[t]??l[l.length-1];break}}r?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":t},r),children:o.map((e=>{let{value:r,label:t,attributes:a}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:n===r?0:-1,"aria-selected":n===r,ref:e=>l.push(e),onKeyDown:u,onClick:c,...a,className:(0,i.Z)("tabs__item",b.tabItem,a?.className,{"tabs__item--active":n===r}),children:t??r},r)}))})}function v(e){let{lazy:r,children:t,selectedValue:i}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(r){const e=a.find((e=>e.props.value===i));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:a.map(((e,r)=>(0,n.cloneElement)(e,{key:r,hidden:e.props.value!==i})))})}function y(e){const r=f(e);return(0,g.jsxs)("div",{className:(0,i.Z)("tabs-container",b.tabList),children:[(0,g.jsx)(j,{...e,...r}),(0,g.jsx)(v,{...e,...r})]})}function P(e){const r=(0,x.Z)();return(0,g.jsx)(y,{...e,children:u(e.children)},String(r))}},1151:(e,r,t)=>{t.d(r,{Z:()=>o,a:()=>s});var n=t(7294);const i={},a=n.createContext(i);function s(e){const r=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(a.Provider,{value:r},e.children)}}}]);