{
  "description": "AIConfig schema, latest version. For older versions, see AIConfigV*.",
  "type": "object",
  "additionalProperties": {},
  "properties": {
    "name": {
      "type": "string"
    },
    "description": {
      "description": "Description of the AIConfig.\nIf you have a collection of different AIConfigs, this may be used for dynamic prompt routing.",
      "type": "string"
    },
    "schema_version": {
      "description": "The version of the AIConfig schema.",
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "major": {
              "type": "number"
            },
            "minor": {
              "type": "number"
            }
          },
          "required": [
            "major",
            "minor"
          ]
        },
        {
          "enum": [
            "latest",
            "v1"
          ],
          "type": "string"
        }
      ]
    },
    "metadata": {
      "description": "Root-level metadata that applies to the entire AIConfig.",
      "type": "object",
      "additionalProperties": {},
      "properties": {
        "parameters": {
          "description": "Parameter definitions that are accessible to all prompts in this AIConfig.\nThese parameters can be referenced in the prompts using {{param_name}} handlebars syntax.\nFor more information, see https://handlebarsjs.com/guide/#basic-usage.",
          "$ref": "#/definitions/JSONObject"
        },
        "models": {
          "description": "Globally defined model settings. Any prompts that use these models will have these settings applied by default,\nunless they override them with their own model settings.",
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/JSONObject"
          }
        }
      }
    },
    "prompts": {
      "description": "Array of prompts that make up the AIConfig.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "description": "A unique identifier for the prompt. This is used to reference the prompt in other parts of the AIConfig (such as other prompts)",
            "type": "string"
          },
          "input": {
            "description": "The prompt string, or a more complex prompt object.",
            "anyOf": [
              {
                "type": "object",
                "properties": {
                  "prompt": {
                    "description": "The prompt string, which may be a handlebars template.",
                    "type": "string"
                  },
                  "data": {
                    "description": "Any additional inputs to the model."
                  }
                },
                "required": [
                  "data",
                  "prompt"
                ]
              },
              {
                "type": "string"
              }
            ]
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {},
            "properties": {
              "parameters": {
                "description": "Parameter definitions that are accessible to this prompt.\nThese parameters can be referenced in the prompt using {{param_name}} handlebars syntax.\nFor more information, see https://handlebarsjs.com/guide/#basic-usage.",
                "$ref": "#/definitions/JSONObject"
              },
              "model": {
                "description": "Model name/settings that apply to this prompt.\nThese settings override any global model settings that may have been defined in the AIConfig metadata.",
                "anyOf": [
                  {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "settings": {
                        "$ref": "#/definitions/JSONObject"
                      }
                    },
                    "required": [
                      "name"
                    ]
                  },
                  {
                    "type": "string"
                  }
                ]
              },
              "tags": {
                "description": "Tags for this prompt. Tags must be unique, and must not contain commas.",
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            },
            "required": [
              "model"
            ]
          },
          "outputs": {
            "description": "Execution, display, or stream outputs.\nIgnore: this is a work-in-progress",
            "type": "array",
            "items": {
              "$ref": "#/definitions/Output"
            }
          }
        },
        "required": [
          "input",
          "metadata",
          "name"
        ]
      }
    }
  },
  "required": [
    "metadata",
    "name",
    "prompts",
    "schema_version"
  ],
  "definitions": {
    "JSONObject": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/JSONValue"
      }
    },
    "JSONValue": {
      "anyOf": [
        {
          "$ref": "#/definitions/JSONObject"
        },
        {
          "type": "array",
          "items": {
            "$ref": "#/definitions/JSONValue"
          }
        },
        {
          "type": [
            "string",
            "number",
            "boolean"
          ]
        }
      ]
    },
    "Output": {
      "description": "Model inference result.\nIgnore: this is a work-in-progress",
      "anyOf": [
        {
          "$ref": "#/definitions/ExecuteResult"
        },
        {
          "$ref": "#/definitions/DisplayData"
        },
        {
          "$ref": "#/definitions/Stream"
        },
        {
          "$ref": "#/definitions/Error"
        }
      ]
    },
    "ExecuteResult": {
      "description": "Result of executing a prompt.",
      "type": "object",
      "properties": {
        "output_type": {
          "description": "Type of output.",
          "type": "string",
          "const": "execute_result"
        },
        "execution_count": {
          "description": "A result's prompt number.",
          "type": [
            "null",
            "number"
          ]
        },
        "data": {
          "description": "A mime-type keyed dictionary of data",
          "type": "object",
          "additionalProperties": {
            "anyOf": [
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              {
                "type": "string"
              }
            ]
          }
        },
        "metadata": {
          "description": "Output metadata.",
          "type": "object",
          "additionalProperties": {}
        }
      },
      "required": [
        "data",
        "execution_count",
        "metadata",
        "output_type"
      ]
    },
    "DisplayData": {
      "description": "Data displayed as a result of inference.",
      "type": "object",
      "properties": {
        "output_type": {
          "description": "Type of output.",
          "type": "string",
          "const": "display_data"
        },
        "data": {
          "description": "A mime-type keyed dictionary of data",
          "type": "object",
          "additionalProperties": {
            "anyOf": [
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              {
                "type": "string"
              }
            ]
          }
        },
        "metadata": {
          "description": "Output metadata.",
          "type": "object",
          "additionalProperties": {}
        }
      },
      "required": [
        "data",
        "metadata",
        "output_type"
      ]
    },
    "Stream": {
      "description": "Stream output from inference.",
      "type": "object",
      "properties": {
        "output_type": {
          "description": "Type of output.",
          "type": "string",
          "const": "stream"
        },
        "name": {
          "description": "The name of the stream (stdout, stderr).",
          "type": "string"
        },
        "text": {
          "description": "The stream's text output, represented as an array of strings.",
          "anyOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "type": "string"
            }
          ]
        }
      },
      "required": [
        "name",
        "output_type",
        "text"
      ]
    },
    "Error": {
      "description": "Output of an error that occurred during inference.",
      "type": "object",
      "properties": {
        "output_type": {
          "description": "Type of output.",
          "type": "string",
          "const": "error"
        },
        "ename": {
          "description": "The name of the error.",
          "type": "string"
        },
        "evalue": {
          "description": "The value, or message, of the error.",
          "type": "string"
        },
        "traceback": {
          "description": "The error's traceback, represented as an array of strings.",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "ename",
        "evalue",
        "output_type",
        "traceback"
      ]
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}